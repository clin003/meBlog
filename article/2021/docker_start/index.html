<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="author" content="白菜林" />
	<meta property="og:url" content="https://3ae.cn/article/2021/docker_start/" />
	<link rel="canonical" href="https://3ae.cn/article/2021/docker_start/" /><style type=text/css>
		body {
			font-family: monospace;
		}
	</style>
	<title>安装docker及简单的使用</title>
	
	
	<meta name="author" content="白菜林">
	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/baicai_custom.css?rnd=1658459874">
	
	
</head>

<body>
	<header>
	===============<br>
	== <a href="https://3ae.cn">白菜林</a> ==<br>
	===============
	<div style="float: right;">一个勤奋的代码搬运工！</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/posts/"><b>文章</b></a>.
			
			<a href="/categories/"><b>分类</b></a>.
			
			<a href="/tags/"><b>标签</b></a>.
			
			<a href="/about/"><b>关于</b></a>.
			
			<a href="https://www.nav.xin"><b>@白菜林</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>安装docker及简单的使用</h1>
			<b><time>2021.10.05 17:21</time></b>
		       
		           <a href="/tags/docker">Docker</a>
        	       

			<div>
				<h2 id="docker的介绍里面包括了3个基本概念">docker的介绍，里面包括了3个基本概念</h2>
<h3 id="11-docker主要由镜像和容器构成">1.1 docker主要由镜像和容器构成</h3>
<p>镜像（Image）:docker镜像好比一个模板，相当于一个文件系统</p>
<p>容器（Container）:容器需要通过镜像来创建。镜像和容器就像是面向对象中的类和实例一样。容器可以被创建/启动/停止/删除等</p>
<p>仓库（Repository）:仓库就是存放镜像的地方，分为私有仓库和公有仓库。类似git</p>
<h3 id="12-docker的运行原理">1.2 docker的运行原理</h3>
<p>docker是一个Client-Server结构的系统，docker的守护进程运行在主机上，通过socket从客户端访问。dockerServer接收到docker-Client的指令，就会执行这个命令。</p>
<h2 id="一-mac-系统-docker-的安装">一. Mac 系统 docker 的安装</h2>
<p>1.1 homebrew的cask应支持Docker for Mac,所以可以直接安装  brew cask install docker</p>
<p>1.2 也可以直接到官网下载，https://download.docker.com/mac/stable/Docker.dmg</p>
<p>1.3 docker的参考文档：https://docs.docker.com</p>
<p>1.4 dockerhub查找镜像源地址：https://hub.docker.com</p>
<h2 id="二-docker的使用">二. docker的使用</h2>
<h3 id="11-查看版本">1.1 查看版本</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker --version
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>docker-compose --version 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>docker-machine --version
</span></span></code></pre></div><h3 id="12-查看docker系统信息包括镜像和容器的数量等">1.2 查看docker系统信息（包括镜像和容器的数量等）</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker info
</span></span></code></pre></div><h3 id="13-帮助命令">1.3 帮助命令</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker help
</span></span></code></pre></div><h3 id="14-查看-cpu的状况">1.4 查看 cpu的状况</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker stats
</span></span></code></pre></div><h2 id="三-docker的基本命令">三. docker的基本命令</h2>
<p>镜像相关命令：</p>
<h3 id="11-查看镜像可用版本nginx为例">1.1 查看镜像可用版本（nginx为例）</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker search nginx
</span></span></code></pre></div><h3 id="12-下载一个镜像">1.2 下载一个镜像</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker pull nginx:latest <span style="color:#75715e">#（：后面跟镜像版本）</span>
</span></span></code></pre></div><h3 id="13-运行一个nginx服务器">1.3 运行一个nginx服务器</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker run -d -p 81:80 --name webserver nginx
</span></span></code></pre></div><p>可选项：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#--name webserver ：容器名称，用来区分容器</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-p 81:80 ：端口进行映射，将本地的81端口映射到容器内部的80端口</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-v ～/nginx/html:/usr/share/nginx/html 数据卷挂载ro/rw，将主机项目中的目录挂载到容器的目录下，默认rw只能在宿主机外改变，容器内部不能改变</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-d：设置容器中在后台一直运行</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-it：使用交互方式运行，进入容器查看内容</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-P：随机端口</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-e：环境配置设置</span>
</span></span></code></pre></div><p>注意：后台启动运行，必须要有一个前台进程，docker发现没有应用，就会自动停止</p>
<p>重点：数据卷挂载分为具名/匿名/指定路径挂载，容器数据卷挂载可以实现数据共享，容器的持久化和同步操作，可以使用docker volume 查看卷的情况，可以使用volumes-from实现多个容器之间的数据共享。</p>
<h3 id="14-停止nginx服务">1.4 停止nginx服务</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker stop webserver<span style="color:#f92672">(</span>容器ID<span style="color:#f92672">)</span>
</span></span></code></pre></div><h3 id="15-删除nginx服务">1.5 删除nginx服务</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker rm webserver
</span></span></code></pre></div><h3 id="16-启动重启nginx服务">1.6 启动/重启nginx服务</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker start/restart webserver
</span></span></code></pre></div><h3 id="17-列出所有镜像列表包含了-仓库名标签镜像-id创建时间-以及-所占用的空间">1.7 列出所有镜像(列表包含了 仓库名、标签、镜像 ID、创建时间 以及 所占用的空间)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker images ls
</span></span></code></pre></div><p>说明：</p>
<pre><code>REPOSITORY 镜像的仓库源

TAG 镜像的标签

IMAGE ID 镜像的id

CREATED 镜像的创建时间

SIZE 镜像的大小
</code></pre>
<p>可选项：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>-a：列出所有的镜像
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-q：只显示镜像的id
</span></span></code></pre></div><p>注意：镜像ID是唯一标识，一个镜像可以对应多个标签</p>
<h3 id="18-查看镜像容器数据卷所占用的空间">1.8 查看镜像、容器、数据卷所占用的空间</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker system df
</span></span></code></pre></div><h3 id="19-删除镜像">1.9 删除镜像</h3>
<p>指定镜像：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker rmi <span style="color:#f92672">[</span>镜像名称/镜像短ID/镜像长ID/镜像摘要<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>多个镜像：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker rmi 镜像ID 镜像ID 镜像ID
</span></span></code></pre></div><p>全部镜像：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker rmi <span style="color:#66d9ef">$(</span>docker images -aq<span style="color:#66d9ef">)</span>
</span></span></code></pre></div><h3 id="20-删除docker-images-ls-命令配合-删除所有仓库名为redis的镜像">2.0 删除docker images ls 命令配合 删除所有仓库名为redis的镜像</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker  rmi <span style="color:#66d9ef">$(</span>docker images ls -q redis<span style="color:#66d9ef">)</span>
</span></span></code></pre></div><h3 id="21-查看镜像运行记录">2.1 查看镜像运行记录</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker history 镜像id
</span></span></code></pre></div><p>容器相关命令</p>
<h3 id="11-列出容器">1.1 列出容器</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker ps 
</span></span></code></pre></div><p>可选项：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#-a：显示所有的容器，包括未运行的</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-l：显示最近创建的容器</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-n：列出最近创建的n个容器</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-q：只显示容器的编号</span>
</span></span></code></pre></div><h3 id="12-进入容器">1.2 进入容器</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker exec -it <span style="color:#f92672">[</span>容器名称<span style="color:#f92672">]</span> /bin/bash
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>docker atthch 容器id
</span></span></code></pre></div><p>区别：docker exec 进入容器后开启一个新的终端，可以在里面操作；docker attach 进入容器正在执行的终端，不会启动新的进程</p>
<h3 id="13-退出容器">1.3 退出容器</h3>
<p>容器停止退回主机</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>exit 
</span></span></code></pre></div><p>容器不停止推出</p>
<pre><code>ctrl+p+q 
</code></pre>
<h3 id="14-删除容器">1.4 删除容器</h3>
<p>指定容器：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker rm <span style="color:#f92672">[</span>容器id<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>多个容器：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker rm 容器id 容器id 容器id
</span></span></code></pre></div><p>所有容器：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker rm <span style="color:#66d9ef">$(</span>docker ps -aq<span style="color:#66d9ef">)</span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>docker ps -a -q|xargs docker rm
</span></span></code></pre></div><p>注意：不能删除正在运行的容器，要删除正在运行的容器需要加 -f 参数，docker rm -f 容器id</p>
<h3 id="15-启动重启容器">1.5 启动/重启容器</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker start/restart 容器id
</span></span></code></pre></div><h3 id="16-停止强制停止容器">1.6 停止/强制停止容器</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker stop/kill 容器id
</span></span></code></pre></div><h3 id="17-查看容器日志">1.7 查看容器日志</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker logs -f -t --tail <span style="color:#ae81ff">100</span> 容器id 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#--tail后面必须加参数条数</span>
</span></span></code></pre></div><h3 id="18-查看容器中的进程信息">1.8 查看容器中的进程信息</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker top 容器id
</span></span></code></pre></div><h3 id="19-查看容器的元数据重要命令">1.9 查看容器的元数据（重要命令）</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker inspect 容器id
</span></span></code></pre></div><h3 id="20-从容器上拷贝数据到主机上">2.0 从容器上拷贝数据到主机上</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker cp 容器id:容器内路径 主机路径
</span></span></code></pre></div><h2 id="四-dockerfile的指令">四. Dockerfile的指令</h2>
<pre><code>FROM 基础镜像，一切从这里开始

MAINTAINER 镜像的作者 姓名&lt;邮箱&gt;

RUN 镜像构建需要运行的命令

ADD 步骤，添加内容

WORKDIR 镜像的工作目录

VOLUME 挂载的目录

EXPOST 端口配置

CMD 指定容器启动要运行的命令，只有最后一个会生效，可被替代

ENTRYPOINT 指定这个容器启动要运行的命令，可以追加命令

ONBUILD 当构建一个被继承的Dockerfile时会运行

COPY 类似ADD将我们文件拷贝到镜像中

ENV 构建的时候设置环境变量
</code></pre>

			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/article/2022/debian_version_check/">查看 Debian 系统版本的方式</a></li>
				
				<li><a href="/article/2022/debian_gnome_remove_game/">删除 Debian Gnome 所有默认安装的游戏</a></li>
				
				<li><a href="/article/2022/ubuntu_kill_port_porc/">如何关闭 Ubuntu 中的开放端口？</a></li>
				
				<li><a href="/article/2022/firefox_weibo_alpn/">解决 Firefox 访问weibo搜索或热搜提示 建立安全连接失败</a></li>
				
				<li><a href="/article/2022/linux_ssh_copy_id/">上传公钥实现ssh登录</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2022 <a href="https://3ae.cn"><b>baicai</b></a>.
	<a href="https://github.com/clin003/meBlog"><b>Github</b></a>.
	<a href="https://support.qq.com/product/325110"><b>反馈</b></a>.
	<a href="https://3ae.cn/donations/"><b>赞助</b></a>.
	<a href="https://nav.3ae.cn/"><b>网络导航</b></a>.
	<a href="https://3ae.cn/links/"><b>友情链接</b></a>.
	<a href="https://lyhuilin.gitee.io"><b>Profile</b></a>.
	<a href="/index.xml"><b>RSS</b></a>.
	</p>
</footer>

</body>

</html>